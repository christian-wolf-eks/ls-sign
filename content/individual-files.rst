
Hashing of individual files
##########################

All cryptographic hashes must be calculated using the SHA-256 or SHA-512 hash algorithms.

All individual files in the zip archive except for the :ref:`cryptographic chain file <crypto-file>` must be individually hashed.

Storage of the hash mapping
===========================

The hashes of the individual files are generated as a simple string.
Each line represents a single file.
The line starts with the hash value, two spaces and the relative file name in the ZIP file.

.. note::
    This file structure is the same as generated by the ``sha256sum`` [Coreutils]_ command line utility to calculate file hashes.

Encoding in XML
===============

The lines in the hash sting have to be stored in XML format to be used in the :ref:`chain file <crypto-file>`.
Each line is encapsulated into an XML tag ``<individual-hash-line>...</individual-hash-line>``.
All hash lines must be collected in an XML tag ``<individual-hashes>...</individual-hashes>``.

.. note:: Example XML snippet

    .. code-block:: XML

        <individual-hashes>
            <individual-hash-line>
                e30809277c049545ff5d815902324f52a1563ba279fed5a87ca1e01cafc2fa14  modelDescription.xml
            </individual-hash-line>
            <individual-hash-line>
                81d63f2cd6bd742859f9b38f7603eb17adb3c8111f4117fa33e96f9460ffc55f   binaries/x86-linux/test.so
            </individual-hash-line>
        </individual-hashes>

Checking by the importer
========================

The importer must check the hashes of each file found in the extracted ZIP file.
Any hash collision must be reported to the user.
Additionally, the user should be able to configure the importer such that the import process is aborted before any binary code from the FMU under test is executed.

If there are files in the FMU which are not part of the hash list, the import must be aborted and an error message must be provided.

Similarly, exceeding entries in the hash mapping list (entries for non-existing files in the FMU) must be reported to the user and there should be an option to abort the execution in this case as well.

